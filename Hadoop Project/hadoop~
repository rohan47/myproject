#!/usr/bin/python

import os,time,fileinput

def main():
	print 'required tools are being installed on this system'
	os.system('yum install nmap sshpass -y')
	nmap()
	ssh_login()
	check=True
	while check:
		print 'Enter 1 for installation'
		print 'Enter 2 to setup namenode'
		print 'Enter 3 to setup datanodes'
		print 'Enter 4 to setup mapreducer'
		print 'Enter anything to exit'
		a=int(raw_input('>'))
		if a==1:
			os.system('./hadoop_install')
			main()
		elif a==2:
			os.system('./name_node_setup')
			main()
		elif a==3:
			os.system('./data_node_setup')
			main()
		else :
			check=False

#installation on nmap and sshpass on the current system

def nmap():
	
	
	ip_range=raw_input('Enter the range of  ip')
	os.system('nmap -n '+ip_range+' | grep -i Nmap\ scan > temphosts.txt')
	os.system('cut -d" " -f5 temphosts.txt > hosts.txt')
	
	
def ssh_login():			
	tmp=open('hosts.txt','r')
	v=tmp.read()
	x=v.split('\n')
	for line in x:
		os.system('sshpass -p \'redhat\' scp installer root@'+line+':/tmp')
		
		print line+'done!!'
		
		
	tmp.close()
	

	
	
	
	
	
main()
	
	
	
	
	
	
